<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Bienvenido</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<script>
async function cargarUsuario() {

    const token = localStorage.getItem("token");

    if (!token) {
        window.location.href = "forbidden.html";
        return;
    }

    const res = await fetch("api/welcome.php", {
        headers: { "Authorization": "Bearer " + token }
    });

    if (res.status === 403) {
        window.location.href = "forbidden.html";
        return;
    }

    const data = await res.json();

    document.getElementById("username").textContent = data.username;
    document.getElementById("hora").textContent = data.time;
    document.getElementById("mensaje").textContent = data.message;
}

function logout() {
    localStorage.removeItem("token");
    localStorage.removeItem("username");
    window.location.href = "login.html";
}
</script>
</head>

<body onload="cargarUsuario()" class="bg-light">

<div class="container mt-5">
    <div class="card shadow p-4">
        <h2>Bienvenido, <span id="username"></span> ðŸ‘‹</h2>
        <p>Hora actual: <strong id="hora"></strong></p>
        <p id="mensaje"></p>

        <button class="btn btn-danger mt-3" onclick="logout()">Cerrar SesiÃ³n</button>
    </div>
</div>

</body>
</html>
